
version: 2
jobs:
  build:
    docker:
      - image: circleci/openjdk:8-jdk
    steps:
      - checkout
      - run:
          name: Deploy
          command: |
            RUN: curl "https://s3.amazonaws.com/aws-cli/awscli-bundle.zip" -o "awscli-bundle.zip"
                 unzip awscli-bundle.zip
                 ./awscli-bundle/install -b ~/bin/aws
           
            PUBLIC_IP=$(curl ipinfo.io/ip)
            
            AWS_REGION=us-east-2
           
            SG_ID=sg-09d7899190ab64d87
         
            RUN: ~/bin/aws ec2 authorize-security-group-ingress --region $AWS_REGION --group-id $SG_ID \
              --protocol tcp --port 22 --cidr $PUBLIC_IP/24
            
            RUN: sleep 5
           
            RUN: ssh -o StrictHostKeyChecking=no ec2@3.80.192.230 \
            
          
